
<div class="main-content" ng-controller="RecordController">
    <h4 class="des border-b">
        档案库
    </h4>
    <div id="exportdiv"></div>
    <form class="form-horizontal" ng-submit="onSearch()">
        <div class="search-ban">
            <div class="col-label-search">
                档案编号
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="PersonID" ng-model="Record.VisitID" placeholder="请输入档案编号">
            </div>
            <div class="col-label-search">
                档案名称
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="VisitName" ng-model="Record.VisitName" placeholder="请输入档案名称">
            </div>
            <div class="col-label-search">
                访问类型
            </div>
            <div class="col-date-search">
                <select id="VisitType" name="VisitType" class="form-control" ng-model="Record.VisitType">
                    <option value="">请选择访问类型</option>
                    <option value="出访">出访</option>
                    <option value="来访">来访</option>
                </select>
            </div>
            <div class="col-label-search">
                访问目的
            </div>
            <div class="col-date-search">
                <select id="VisitFor" name="VisitFor" class="form-control" ng-model="Record.VisitFor">
                    <option value="">请选择访问目的</option>
                    <option value="友好访问">友好访问</option>
                    <option value="会议">会议</option>
                    <option value="特别活动">特别活动</option>
                    <option value="培训">培训</option>
                    <option value="讲课">讲课</option>
                    <option value="其他">其他</option>
                </select>
            </div>
            <div class="col-label-search">
                主要经办部门
            </div>
            <div class="col-date-search">
                <select id="MainDepartment" name="MainDepartment" class="form-control" ng-model="Record.MainDepartment">
                    <option value="">请选择主要经办部门</option>
                    <option value="财政部">财政部</option>
                    <option value="教育部">教育部</option>
                    <option value="农业部">农业部</option>
                    <option value="文化部">文化部</option>
                    <option value="外交部">外交部</option>
                    <option value="国防部">国防部</option>
                    <option value="司法部">司法部</option>
                    <option value="交通运输部">交通运输部</option>
                </select>
            </div>
            <div class="div-clear"></div>
            <div class="col-label-search">
                主要经办人
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="MianPerson" ng-model="Record.MianPerson" placeholder="请输入主要经办人">
            </div>
            <div class="col-label-search">
                行程开始日期
            </div>
            <div class="col-date-search">
                <input id="FromDate" class="form-control" datepicker size="16" type="text" ng-model="Record.FromDate" placeholder="请输入开始日期" />
            </div>
            <div class="col-label-search">
                行程结束日期
            </div>
            <div class="col-date-search">
                <input id="EndDate" class="form-control" datepicker size="16" type="text" ng-model="Record.EndDate" placeholder="行程结束日期" />
            </div>
            <div class="col-label-search">
                接待/出访人员
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="OurPerson" ng-model="Record.OurPerson" placeholder="请输入接待/出访人员">
            </div>
            <div class="col-label-search">
                来访/接待领队
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="TheyPerson" ng-model="Record.TheyPerson" placeholder="请输入来访/接待领队">
            </div>
            <div class="div-clear"></div>
            <div class="col-label-search">
                邀请机构
            </div>
            <div class="col-date-search">
                <input type="text" class="form-control" id="BeViOrg" ng-model="Record.BeViOrg" placeholder="请输入邀请机构">
            </div>

            <div class="col-label-search">
                访问性质
            </div>
            <div class="col-date-search">
                <select id="VisType" name="VisType" class="form-control" ng-model="Record.VisType">
                    <option value="">请选择访问性质</option>
                    <option value="正式">正式</option>
                    <option value="散客">散客</option>
                    <option value="上级安排">上级安排</option>
                    <option value="其他">其他</option>
                </select>
            </div>
            <div class="col-label-search">
                费用承担
            </div>
            <div class="col-date-search">
                <select id="FeeType" name="FeeType" class="form-control" ng-model="Record.FeeType">
                    <option value="">请选择费用承担</option>
                    <option value="公费">公费</option>
                    <option value="自费">自费</option>
                </select>
            </div>
            <div class="col-date-search">
                <button class="btn base" type="submit" style="padding:5px 10px;">{{'btnSearch' | translate}}</button>
            </div>
            <div class="col-date-search">
                <button class="btn base" type="button" ng-click="showEdit()" style="padding:5px 10px;" has-permission="FN03001">录入</button>
            </div>
            <div class="col-date-search">
                <a class="btn base" ng-click="exportexcel()" style="padding:5px 10px;">导出</a>
            </div>
            <div class="div-clear"></div>
        </div>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>访问类型</th>
                    <th>档案编号</th>
                    <th>档案名称</th>
                    <th>访问目的</th>
                    <th>主要经办部门</th>
                    <th>总行程</th>
                    <th>访问性质</th>
                    <th>费用承担</th>
                    <th style="text-align:center">{{'lblOperator'|translate}}</th>
                </tr>
            </thead>
            <tbody ng-show="ListItems == null || ListItems.length == 0">
                <tr>
                    <td colspan="5">{{'msgNoData'|translate}}</td>
                </tr>
            </tbody>
            <tbody>
                <tr ng-repeat="item in ListItems">
                    <td>{{item.VisitType}}</td>
                    <td>{{item.VisitID}}</td>
                    <td>{{item.VisitName}}</td>
                    <td>{{item.VisitFor}}</td>
                    <td>{{item.MainDepartment}}</td>
                    <td>{{item.FromDate}}-{{item.EndDate}}</td>
                    <td>{{item.VisType}}</td>
                    <td>{{item.FeeType}}</td>
                    <td style="text-align:center">
                        <a class="btn btn-info" ui-sref='Index.RecordEdit({VisitID:"{{item.VisitID}}"})' has-permission="FN03001">
                            <i class="glyphicon glyphicon-edit"></i>
                            编辑
                        </a>
                        <a class="btn btn-info" ui-sref='Index.RecordDetail({VisitID:"{{item.VisitID}}"})'>
                            <i class="glyphicon glyphicon-edit"></i>
                            详情
                        </a>
                        <a class="btn btn-info" ng-click="onDelete(item.VisitID)" has-permission="FN03002">
                            <i class="glyphicon glyphicon-trash"></i>
                            删除
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>

        <!--分页控件-->
        <pager-nav page-list="[5,10,20,25]"
                   page="CurrentPage"
                   page-Size="pageSize"
                   total-Count="totalCount" on-change="onSearch()" />

    </form>
</div>
<style>
    .col-label-search {
        min-width: 100px;
    }
</style>